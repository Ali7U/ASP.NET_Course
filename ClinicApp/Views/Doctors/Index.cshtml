@model DoctorFilterdListVM

<h1>Doctors</h1>

<partial name="_Filter" model="Model.Filter"/>

<div>
    <a asp-controller="Doctors" asp-action="Register">Register</a>

    <ol>
        @foreach (var d in Model.Doctors)
        {
            <li>
                <a asp-controller="Doctors" asp-action="Details" asp-route-id="@d.Id">
                    @d.FirstName @d.LastName
                </a>
                <a class="btn btn-primary" asp-controller="Doctors" asp-action="Update" asp-route-id="@d.Id">
                    <i class="bi bi-pencil-square"></i>
                    </a>
                <a class="btn btn-danger js-btn-delete" data-id="@d.Id" >
                    <i class="bi bi-person-x"></i>
                </a>
            </li>
         
            
        }
    </ol>
    <partial name="_Pagination" model="Model.Filter"/>
</div>

@section Scripts{
    <script>
        $(".js-btn-delete").on("click", function () {
            const btn = $(this);
            const id = $(this).data("id");
            const isConfirmed = confirm("Are you sure you want to delete this doctor?");
            if(isConfirmed){
                $.ajax({
                    url: `/Doctors/Delete/${id}`,
                    success: function () {
                        btn.parents("li").remove();                    },
                    error: function (error) {
                        alert("An error occurred while trying to delete the patient: " + error);
                    }
                })
            }
        })
        
        $(".js-page-link").on("click", function () {
            
            var page = $(this).data("page");
            $("#patient-doctor-form #Page").val(page);
            $("#patient-doctor-form").submit();
            
        })
    </script>    
}